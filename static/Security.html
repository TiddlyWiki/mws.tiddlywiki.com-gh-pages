<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.4.0-prerelease" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>Security: TiddlyWiki MultiWikiServer â€” TiddlyWiki for the People</title>
</head>
<body class="tc-body">
<p><div class="tc-static-alert"><div class="tc-static-alert-inner">This page is part of a static HTML representation of the TiddlyWiki at <a class="tc-tiddlylink-external" href="https://mws.tiddlywiki.com/" rel="noopener noreferrer" target="_blank">https://mws.tiddlywiki.com/</a></div></div>
</p>
<section class="tc-story-river tc-static-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists  tc-tagged-TableOfContents" data-tags="TableOfContents" data-tiddler-title="Security" role="article"><div class="tc-tiddler-title tc-clearfix"><div class="tc-titlebar"><span class="tc-tiddler-controls"><button aria-expanded="false" aria-label="more" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="More actions"></button><span class=" tc-reveal" hidden="true"></span><button aria-label="Edit this tiddler" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="Edit this tiddler"></button><button aria-label="close" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="Close this tiddler"></button></span><span><h2 class="tc-title">Security</h2></span></div><div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div></div><div class="tc-reveal"></div><div class=" tc-reveal"><div class="tc-subtitle tc-clearfix">9th July 2025 at 1:38pm</div></div><div class=" tc-reveal"><div class="tc-tags-wrapper"><span class="tc-tag-list-item" data-tag-title="TableOfContents"><span aria-expanded="false" class="tc-tag-label tc-btn-invisible" draggable="true" style="fill:<<cssvar foreground>>;color:<<cssvar foreground>>;"><span class="tc-tag-exists">TableOfContents</span></span><span class="tc-drop-down tc-reveal" hidden="true"></span></span></div></div><div class="tc-tiddler-body tc-clearfix tc-reveal"><div class="markdown">
<h2>Use Cases</h2>
<p>The primary use cases for MWS are
</p>
<ul>
<li>Internal corporate information tools</li>
<li>Public TiddlyWiki hosting</li>
<li>Classroom scenarios</li>
<li>Unrestricted trusted collaboration</li>
</ul>
<h2>Still in Development</h2>
<p>While these are the goals of MWS, it is still in early development, so none of these security restraints have actually been put in place yet. This is a work in progress, and the direction we're headed.
</p>
<h2>Don't add untrusted bags to your recipe.</h2>
<p>Generally speaking, wiki text is quite powerful, almost as powerful as JavaScript. Button clicks can run widget actions, which can read and change any tiddler in the current recipe. Any user could easily cause TiddlyWiki to write tiddlers to other bags via actions.
</p>
<p>A user can also modify a bag they have write access to so that when a different user loads that bag in their own recipe it gives the first user access to tiddlers that the second user would consider private. This flaw is almost inherent to the idea of bags and recipes and cannot be avoided.
</p>
<h2>Potential weaknesses</h2>
<ul>
<li><strong>Not using HTTPS</strong> is always the number one weakness. If you're on an open WIFI network, your session info can be read by anyone within 100 meters.</li>
<li><strong>Oracles</strong> that leak information through observable side-effects, such as network traffic, without directly revealing the contents.</li>
<li><strong>Multi-user</strong>: Users with write access can modify bags to gain access to other tiddlers in a different recipe that are supposed to be private.</li>
</ul>
<h2>Protection strategies</h2>
<p>I just needed some place to list all the different things we could do to secure a site. Some of these would be optional depending on the level of mitigation required.
</p>
<ol>
<li>Obvious, "tie your shoes" security precautions.</li>
<li>Reasonable prevention of normal attack vectors.</li>
<li>Optional hardening to prevent targeted attacks.</li>
<li>Pedantic defenses against advanced attackers with full read-only access to the system or a backup.</li>
</ol>
<h3>HTTPS</h3>
<ul>
<li>Enable HTTPS site-wide using let's encrypt or another free certificate service.</li>
</ul>
<h3>Cookies</h3>
<p><a class="tc-tiddlylink-external _codified_" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Set-Cookie" rel="noopener noreferrer" target="_blank">MDN - SetCookie</a>
</p>
<ul>
<li>Secure, HttpOnly, SameSite=strict, attributes</li>
<li>Setting separate session cookies for the admin and wiki paths doesn't work because it's based on the request path, not the page path.</li>
<li>Having a separate login subdomain and using oauth is a more complicated option.</li>
</ul>
<h3><code class="_codified_">no-cors</code></h3>
<ul>
<li>JavaScript <code class="_codified_">no-cors</code> mode allows <code class="_codified_">GET</code>, <code class="_codified_">HEAD</code>, and <code class="_codified_">POST</code> and sends relevant cookies.</li>
<li><strong><code class="_codified_">no-cors</code> prevents most headers, including custom headers, from being set.</strong></li>
<li>Our standard <code class="_codified_">x-requested-with</code> header cannot be set.</li>
</ul>
<h3>CORS headers</h3>
<ul>
<li>Set CORS header to only allow expected origins. This doesn't prevent external CLI tools from accessing the site, only browser-based tools. This could also be set for certain endpoints or recipes to only allow specific bags to receive external requests.</li>
</ul>
<h3><code class="_codified_">Referer</code> header</h3>
<ul>
<li>Only allow a wiki to access its own recipe endpoints for extra tight security. It is difficult to predict when a specific request might be malicious if tools are allowed to make requests from one recipe to another on a user's behalf. Specific referer headers could be white-listed as approved tool wikis.</li>
<li>Don't allow wiki pages to access admin APIs.</li>
</ul>
<h3><code class="_codified_">Content-Security-Policy</code> header</h3>
<ul>
<li>Able to block the page from making network requests, putting it in mostly read-only mode. This doesn't stop JavaScript from setting <code class="_codified_">location.href</code> nor prevent the user from clicking on <code class="_codified_">a href</code> links. This is more of a quick and dirty read-only, since it prevents ALL requests, including requests that might not actually change anything on the server.</li>
</ul>
<h3>Other site configuration</h3>
<ul>
<li>Don't allow admins to edit a wiki unless they are added to the ACL. The CSP header could be used to disable all network requests if the admin role does not have read permission, thus giving them true read-only access to the wiki.</li>
<li>If compression is used, do not compress two bags in the same compression stream. This is a fairly extreme precaution with a limited likelihood.</li>
</ul>
<h2>Other ideas</h2>
<p>When you visit a page, you visit with page permissions only, and the page has to ask permission to use your full account permissions. The request could also be granular, where the page has to request the specific bag or wiki it wants access to.
</p>
</div></div>
</div></p>
</section>
</body>
</html>

