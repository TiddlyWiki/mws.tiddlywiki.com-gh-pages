<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.4.0-prerelease" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>2025-04-14 - client plugins ✔️: TiddlyWiki MultiWikiServer — TiddlyWiki for the People</title>
</head>
<body class="tc-body">
<p><div class="tc-static-alert"><div class="tc-static-alert-inner">This page is part of a static HTML representation of the TiddlyWiki at <a class="tc-tiddlylink-external" href="https://mws.tiddlywiki.com/" rel="noopener noreferrer" target="_blank">https://mws.tiddlywiki.com/</a></div></div>
</p>
<section class="tc-story-river tc-static-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists  tc-tagged-Roadmap" data-tags="Roadmap" data-tiddler-title="2025-04-14 - client plugins ✔️" role="article"><div class="tc-tiddler-title tc-clearfix"><div class="tc-titlebar"><span class="tc-tiddler-controls"><button aria-expanded="false" aria-label="more" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="More actions"></button><span class="tc-reveal" hidden="true"></span><button aria-label="Edit this tiddler" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="Edit this tiddler"></button><button aria-label="close" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="Close this tiddler"></button></span><span><h2 class="tc-title">2025-04-14 - client plugins ✔️</h2></span></div><div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div></div><div class="tc-reveal"></div><div class="tc-reveal"><div class="tc-subtitle tc-clearfix">24th June 2025 at 1:06pm</div></div><div class="tc-reveal"><div class="tc-tags-wrapper"><span class="tc-tag-list-item" data-tag-title="Roadmap"><span aria-expanded="false" class="tc-tag-label tc-btn-invisible" draggable="true" style="color:<<cssvar foreground>>;"><span class="tc-tag-exists">Roadmap</span></span><span class="tc-drop-down tc-reveal" hidden="true"></span></span></div></div><div class="tc-tiddler-body tc-clearfix tc-reveal"><div class="markdown">
<p>Currently we're adding recipe tiddlers into the wiki page dynamically, which is expected, but there are like six tiddlers that are being rendered statically, which doesn't really make sense. It also doesn't make sense that we're dumping some plugins into the database but rendering core from tiddlywiki, since this results in a version mismatch.
</p>
<p>At the same time, we really don't want to be rendering plugins every time. They do need to be cached somewhere so they can be loaded quickly. I wonder if it would work to cache them in the wiki folder, per tiddlywiki version, so if you upgrade it would just create a new folder. The boot tiddlers would be cached in the folder as well. If we do it right, we wouldn't even have to parse the file, just read it onto the wire. We'd probably need an index file to keep everything straight. We could add plugins/themes/languages support to the wiki folder as well, which would also get cached in the same way. We could make a way for caching to be disabled, perhaps by adding a field to <code class="_codified_">plugin.info</code>.
</p>
<p>It would be useful if the plugin syntax could specify NPM modules. We already have the <code class="_codified_">+</code> and <code class="_codified_">++</code> syntax. I'm not sure exactly how it'd work, but the NPM package would need to determine it's own path, which is fairly simple, and then export that so it can be imported via the standard import mechanism. Obviously the package would need to be installed, and it should probably be imported into the run file and then added as an absolute path to the list of imports. Actually, I guess that's already possible, so I just need to add the list of imports part of it.
</p>
<hr>
<h3>Add a tiddler cache folder and render the tiddlers on startup</h3>
<ul>
<li>Store them either in-memory or in the file-system, depending on user preference.</li>
<li>The core tiddler and boot tiddlers could be stored in memory regardless because they are always served.</li>
<li>Would it save some memory to store them as a buffer?</li>
<li>The stored content would be read directly onto the wire, optionally checking the hash.</li>
</ul>
<h3>Add a plugin selector to the recipes form</h3>
<ul>
<li>The loading order needs to be changeable.</li>
<li>It would just be an array of titles, and possibly other describing fields.</li>
</ul>
<h3>Add a plugin field to the recipes table</h3>
<ul>
<li>Not sure if I need to create a plugins table but I probably just need a string array of plugin names. Titles tend to be authoritative in TiddlyWiki so the plugin title should be enough. Plugin titles which cannot be found would be somehow marked as not found, probably with a custom disabled plugin tiddler in the client and logging a warning in the server.</li>
</ul>
<h3>What about SQL Filters?</h3>
<ul>
<li>I don't know, but we would be caching plugins either way. Everything about it is handled differently, so no matter what, there is almost guaranteed to be a clear separation between the two kinds of bags anyway. We'll worry about that when we get there.</li>
</ul>
<h2>Retrospective - 2025-06-24</h2>
<p>I ended up caching it according to the file path. The tiddlywiki file path works fine for those plugins. Third-party plugins will need to declare their own folder name somehow. The files are compressed and stored on disk. The cache is built on startup. The cache stores a <code class="_codified_">json</code>, <code class="_codified_">js</code>, and <code class="_codified_">js.gz</code> version of each plugin.
</p>
</div></div>
</div></p>
</section>
</body>
</html>

